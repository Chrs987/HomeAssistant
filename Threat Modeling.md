# Design for Software Security Engineering


## Configuration.Yaml Threat Model 1

![level1](/images/EditConfig.YamlFile.PNG)

![Configuration.Yaml Report](/reports/Configuration.YamlReport.pdf)

## Threat Model 2


### Threat Model 2 Level 1

![level1](/images/Nobu_Casa_Threat.PNG)

![Configuration.Yaml Report](/reports/Nobu_Casa_Threat.pdf)


## Threat Model 3


### Threat Model 3 Level 1

TODO: Insert HTML Report


## Update Addon Threat Model 4

![level1](/images/Update_Addon.png)

[Update Addon Report](/reports/Update_Addon_Report.pdf)


## Threat Model 5


### Threat Model 5 Level 1

TODO: Insert HTML Report

## Summary of Observations

Overall Home Assistant was able to mitigate or mark the threats as "Not Applicable." One of the major advantages of using Home Assistant is that it is not dependent on cloud services and runs primarily on the users’ local network. This allows Home Assistant to control, communicate, and operate without having to communicate with the internet. A bulk of Home Assistants features can be controlled from the user’s local network without exposing Home Assistant to the outside world, however this does take away the effectiveness of the software. For Home Assistant to run effectively it will need to communicate with external (outside of the network) applications such as GitHub, Credstash, Cloud Services, and Remote Management. These all need to be manually enabled by the user and Home Assistant offers some [documentation](https://www.home-assistant.io/docs/configuration/securing/) on how to secure the software to prevent against the different S.T.R.I.D.E. threats. We evaluated the S.T.R.I.D.E. threats generated by [Microsoft's Threat Modeling Tool](https://www.microsoft.com/en-us/download/details.aspx?id=49168) and presented our findings below. The findings below are the cumulative results for each threat model we created above.

## Repudation

Home Assistant gives users the ability to view the system logs in several ways. The user can view it from the Lovelace Interface (the web GUI) or on the actual device itself in the `home-assistant.log` and `system_log_event` files on the host machine. Logging is done via [System Log](https://www.home-assistant.io/integrations/system_log/) which keeps track of all logged errors and warnings for the IoT devices the hub manages. Errors and warnings are posted as the event in the `system_log_event` file while more detailed logging is stored in the `home-assistant.log` file. 

--------------------------

### Spoofing


### Tampering
Home Assistant gives the user the ability to have mechanisms in place to help mitigate Tampering of the system. Following the [securing documentation](https://www.home-assistant.io/docs/configuration/securing/) provides the user with a secure platform of Home Assistant. The two main forms of tampering that Home Assistnat is prone to are Physical and Digital. Physical Tampering should be mitigated by the user. Digital Tampering to the system is mitigated by only having accounts with root access able to edit config files on the system. Some risk that does apply to the applicaiton are from community add-ons. The community add-ons that are advertised have been community vetted [Community Add-Ons ](https://community.home-assistant.io/tags/hassio-repository). 

### Repudiation


### Information Disclosure


### Denial of Service
Since Home Assistant lives on the user’s home network, there is very little possibility when it comes to a denial of service attack. As stated in the observation summary above, Home Assistant prides itself in security and is not reliant on cloud services. Without any additional features installed on the device Home Assistant only communicates with GitHub for addon installations and software updates. It is only when the device is configured for [Remote Access](https://www.nabucasa.com/) that it will be exposed to the outside world. Home Assistant recommends that users use a VPN, an SSH tunnel, or TLS/SSL if they want to expose their instance to the internet in their [securing documentation](https://www.home-assistant.io/docs/configuration/securing/). The user would have to forward a port on their router which could be susceptible to a denial of service attack, but since this is a home-use software, the risk is accepted. Home Assistant does recommend that the user should consider encrypting traffic for all remote connections in their [WiKi documentation](https://community.home-assistant.io/t/installing-tls-ssl-using-lets-encrypt/196975).

### Elevation of Privilege

Home Assistant provides several measures of protection against elevation of privilege attacks. Since the software runs on the user’s local network, the possibility of an escalation of privilege attack is low, however Home Assistant does offer several features that the user can use to protect the device from this threat. When the user first installs the software the Home Assistant [WiKi documentation](https://www.home-assistant.io/docs/authentication/) walks the user through creating their userID and secure password. Home Assistant also recommends that users enable [multi-factor authentication](https://www.home-assistant.io/docs/authentication/multi-factor-auth/) adding another level of security to the root user account. On top of authentication methods, all addons installed from GitHub are ran in [protection enabled mode](https://developers.home-assistant.io/docs/add-ons/security/) which prevents addons from getting any rights on the system. Addons will prompt the user if more rights are needed, however Home Assistant strongly recommends not doing this as it could compromise the device. Another useful feature that Home Assistant offers to protect user accounts is that all addons are stored in separate docker containers on which only interact with Home Assistant and nothing else. As mentioned in the [Repudiation](#Repudiation) section, Home Assistant contains detailed logging, and the user will be able to see all interaction for the different user accounts and addons. Home Assistant even allows the users to create automation scripts that will trigger when an elevation of privilege attack is attempted.

--------------------------

### Link to Repo

[GitHub Repo Link](https://github.com/Chrs987/HomeAssistant/projects/4)

### Reflection

While GitHub has been beneficial in the past, we found this assignment rather difficult to do remotely. We broke the assignment into different DFD's based off our use/misuse cases and created individual reports for our DFD's. I believe this assignment would have been a good assignment to do together in a conference room, but we managed to make it work remotely as best we could. The summaries for each of the S.T.R.I.D.E. threats proved difficult to manage of GitHub. We wanted to have a generic summary of our observations, but we also did not want to have individual summaries for our specific DFD model. The logistics of this proved difficult since GitHub would overwrite the summary that another user wrote when we went to submit our merge and pull request so we decided that we would create .txt (text) documents for each element of S.T.R.I.D.E. and share they via our teams Discord server so our group could edit them as they see fit without overwriting or restating the others work. We feel GitHub works better when we can break stuff into individual sections, but we managed to effectively work together and help each other out despite some of the issues going on in our group's personal lives.
